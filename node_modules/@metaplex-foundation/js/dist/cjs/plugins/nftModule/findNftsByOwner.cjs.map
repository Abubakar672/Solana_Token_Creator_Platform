{"version":3,"file":"findNftsByOwner.cjs","sources":["../../../../src/plugins/nftModule/findNftsByOwner.ts"],"sourcesContent":["import { PublicKey } from '@solana/web3.js';\nimport { Metaplex } from '@/Metaplex';\nimport { TokenProgram } from '@/programs';\nimport { Operation, OperationHandler, useOperation } from '@/types';\nimport { findNftsByMintListOperation } from './findNftsByMintList';\nimport { Nft } from './Nft';\n\nconst Key = 'FindNftsByOwnerOperation' as const;\nexport const findNftsByOwnerOperation =\n  useOperation<FindNftsByOwnerOperation>(Key);\nexport type FindNftsByOwnerOperation = Operation<typeof Key, PublicKey, Nft[]>;\n\nexport const findNftsByOwnerOnChainOperationHandler: OperationHandler<FindNftsByOwnerOperation> =\n  {\n    handle: async (\n      operation: FindNftsByOwnerOperation,\n      metaplex: Metaplex\n    ): Promise<Nft[]> => {\n      const owner = operation.input;\n\n      const mints = await TokenProgram.tokenAccounts(metaplex)\n        .selectMint()\n        .whereOwner(owner)\n        .whereAmount(1)\n        .getDataAsPublicKeys();\n\n      const nfts = await metaplex\n        .operations()\n        .execute(findNftsByMintListOperation(mints));\n\n      return nfts.filter((nft): nft is Nft => nft !== null);\n    },\n  };\n"],"names":["Key","findNftsByOwnerOperation","useOperation","findNftsByOwnerOnChainOperationHandler","handle","operation","metaplex","owner","input","mints","TokenProgram","tokenAccounts","selectMint","whereOwner","whereAmount","getDataAsPublicKeys","nfts","operations","execute","findNftsByMintListOperation","filter","nft"],"mappings":";;;;;;;;AAOA,MAAMA,GAAG,GAAG,0BAAZ,CAAA;MACaC,wBAAwB,GACnCC,sBAAY,CAA2BF,GAA3B,EADP;AAIA,MAAMG,sCAAkF,GAC7F;AACEC,EAAAA,MAAM,EAAE,OACNC,SADM,EAENC,QAFM,KAGa;AACnB,IAAA,MAAMC,KAAK,GAAGF,SAAS,CAACG,KAAxB,CAAA;IAEA,MAAMC,KAAK,GAAG,MAAMC,yBAAY,CAACC,aAAb,CAA2BL,QAA3B,CACjBM,CAAAA,UADiB,GAEjBC,UAFiB,CAENN,KAFM,CAGjBO,CAAAA,WAHiB,CAGL,CAHK,CAAA,CAIjBC,mBAJiB,EAApB,CAAA;AAMA,IAAA,MAAMC,IAAI,GAAG,MAAMV,QAAQ,CACxBW,UADgB,EAEhBC,CAAAA,OAFgB,CAERC,8CAA2B,CAACV,KAAD,CAFnB,CAAnB,CAAA;IAIA,OAAOO,IAAI,CAACI,MAAL,CAAaC,GAAD,IAAqBA,GAAG,KAAK,IAAzC,CAAP,CAAA;AACD,GAAA;AAlBH;;;;;"}