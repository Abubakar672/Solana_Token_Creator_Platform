{"version":3,"file":"metadataHelpers.esm.js","sources":["../src/utils.ts","../src/MetadataStorageLayer.ts","../src/webAuthnShareResolver.ts"],"sourcesContent":[null,null,null],"names":["keccak256","a","createKeccakHash","update","digest","ec","EC","MetadataStorageLayer","constructor","metadataHost","serverTimeOffset","setAPIKey","apiKey","setEmbedHost","embedHost","generateMetadataParams","message","privateKeyHex","key","keyFromPrivate","setData","data","timestamp","Math","floor","Date","now","toString","sig","sign","stringify","pub_key_X","getPublic","getX","pub_key_Y","getY","set_data","signature","Buffer","from","r","s","recoveryParam","padStart","slice","generatePubKeyParams","setMetadata","namespace","options","params","metadataResponse","post","useAPIKey","getMetadata","pubKey","WEBAUTHN_TORUS_SHARE","WEBAUTHN_DEVICE_SHARE","encParamsHexToBuf","encParamsHex","iv","ephemPublicKey","ciphertext","mac","encParamsBufToHex","encParams","encryptData","privKeyHex","d","serializedDec","JSON","serializedBuf","encrypt","sData","decryptData","parse","keyPair","decrypt","getPrivate","getAndDecryptData","m","serializedData","encryptAndSetData","metadataParams","setTorusShare","webAuthnPubKey","webAuthnRefHex","subspace","subspaceData","refKeyPair","privKey","keyFromPublic","x","y","serializedSubspaceData","serializedSubspaceDataBuf","encSubspaceData","encSubspaceDataHex","setDeviceShare","getTorusShare","webAuthnKeyHex","getDeviceShare"],"mappings":"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"}